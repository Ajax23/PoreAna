<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>MC.log_likelihood_radial &#8212; PoreAna 0.2.0 documentation</title>
    <link rel="stylesheet" href="../_static/bootstrap-sphinx.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../_static/style.css" type="text/css" />
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '0.2.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true,
        SOURCELINK_SUFFIX: '.txt'
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
<meta charset='utf-8'>
<meta http-equiv='X-UA-Compatible' content='IE=edge,chrome=1'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1'>
<meta name="apple-mobile-web-app-capable" content="yes">
<script type="text/javascript" src="../_static/js/jquery-1.11.0.min.js "></script>
<script type="text/javascript" src="../_static/js/jquery-fix.js "></script>
<script type="text/javascript" src="../_static/bootstrap-3.3.7/js/bootstrap.min.js "></script>
<script type="text/javascript" src="../_static/bootstrap-sphinx.js "></script>

  </head>
  <body>

  <div id="navbar" class="navbar navbar-default navbar-fixed-top">
    <div class="container">
      <div class="navbar-header">
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="../index.html">
          PoreAna</a>
        <span class="navbar-text navbar-version pull-left"><b>0.2</b></span>
      </div>

        <div class="collapse navbar-collapse nav-collapse">
          <ul class="nav navbar-nav">
            
                <li><a href="../api.html">API</a></li>
                <li><a href="../density.html">Density</a></li>
                <li><a href="../diffusion.html">Diffusion</a></li>
                <li><a href="../diffusion_mc.html">Diffusion (MC)</a></li>
            
            
              <li class="dropdown globaltoc-container">
  <a role="button"
     id="dLabelGlobalToc"
     data-toggle="dropdown"
     data-target="#"
     href="../index.html">Site <b class="caret"></b></a>
  <ul class="dropdown-menu globaltoc"
      role="menu"
      aria-labelledby="dLabelGlobalToc"></ul>
</li>
              
                <li class="dropdown">
  <a role="button"
     id="dLabelLocalToc"
     data-toggle="dropdown"
     data-target="#"
     href="#">Page <b class="caret"></b></a>
  <ul class="dropdown-menu localtoc"
      role="menu"
      aria-labelledby="dLabelLocalToc"><ul>
<li><a class="reference internal" href="#">MC.log_likelihood_radial</a></li>
</ul>
</ul>
</li>
              
            
            
            
            
            
          </ul>

          
            
<form class="navbar-form navbar-right" action="../search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
          
        </div>
    </div>
  </div>

<div class="container">
  <div class="row">
    <div class="body col-md-12 content" role="main">
      
  </div>
<div class=col-md-9 content><div class="section" id="mc-log-likelihood-radial">
<h1>MC.log_likelihood_radial<a class="headerlink" href="#mc-log-likelihood-radial" title="Permalink to this headline">¶</a></h1>
<dl class="method">
<dt id="poreana.mc.MC.log_likelihood_radial">
<code class="descclassname">MC.</code><code class="descname">log_likelihood_radial</code><span class="sig-paren">(</span><em>model</em>, <em>wrad</em><span class="sig-paren">)</span><a class="headerlink" href="#poreana.mc.MC.log_likelihood_radial" title="Permalink to this definition">¶</a></dt>
<dd><p>This function estimate the likelihood of the current radial diffusion profile over the bins in a simulation box. This likelihood is necessary to decide whether the MC step will be accepted.</p>
<div class="math">
\[\ln \ L(M) = \sum_{m,i \leftarrow j} \ln \left( \left[ \Delta r \sum_{\alpha_k} 2 r_m \frac{J_0(\alpha_kr_m)}{s^2J_1^2(x_k)} [e^{(R-\alpha_k^2D)\Delta_{ij}t_{\alpha}}]_{ij} \right] ^{N_{m,ij}(\Delta_{ij}t_{\alpha})} \right)\]</div>
<p>with <span class="math">\(t_{i}\)</span> as the current lag time and <span class="math">\(N_{m,ij}(t_i)\)</span> as the radial transition matrix, <span class="math">\(J_0\)</span> as the roots of the Bessel function and <span class="math">\(J_1\)</span> as the 1st order Bessel first type in those zeros. The variable <span class="math">\(s\)</span> is the length where the bessel function going to zero and <span class="math">\(r_m\)</span> is the middle of the radial bin. The lag time is <span class="math">\(t_{i}\)</span> and <span class="math">\(D\)</span> is the current radial diffusion profile.
The rate matrix <span class="math">\(R\)</span> from <a class="reference internal" href="poreana.mc.MC.init_rate_matrix_pbc.html#poreana.mc.MC.init_rate_matrix_pbc" title="poreana.mc.MC.init_rate_matrix_pbc"><code class="xref py py-func docutils literal"><span class="pre">init_rate_matrix_pbc()</span></code></a> which constant over the radial diffuison determination and is calculated with the normal diffusion and the free energy profile is need. This the reason why the normal diffusion calculation is necessary for the radial diffusion calculation.</p>
<p>The transition matrix <span class="math">\(N_{m,ij}(t_i)\)</span> contains all observed number of transition of a particle being in z-bin i and radial bin m after a lag time t, given that it was in z-bin j and r = 0 at the start.
This matrix is sampled with the function <code class="xref py py-func docutils literal"><span class="pre">init_diffusion_mc()</span></code> from a simulated trajectory at the beginning and depends on the lag time.</p>
<p>The bessel part</p>
<div class="math">
\[\mathrm{bessel} = \sum_{\alpha_k} 2r_m \frac{J_0(\alpha_kr_m)}{s^2J_1^2(x_k)}\]</div>
<p>of the likelihood does not depend on the radial diffusion profile and is determined with the function <a class="reference internal" href="poreana.mc.MC.setup_bessel_box.html#poreana.mc.MC.setup_bessel_box" title="poreana.mc.MC.setup_bessel_box"><code class="xref py py-func docutils literal"><span class="pre">setup_bessel_box()</span></code></a></p>
<p>The function <code class="xref py py-func docutils literal"><span class="pre">log_likelihood_box_radial()</span></code> determine the rate matrix part of the Likelihood</p>
<div class="math">
\[\mathrm{rate}_{\mathrm{radial}} = \left [e^{(R-\alpha_k^2D)\Delta_{ij}t_{\alpha}}]_{ij}\]</div>
<p>multiple it with the results from the <a class="reference internal" href="poreana.mc.MC.setup_bessel_box.html#poreana.mc.MC.setup_bessel_box" title="poreana.mc.MC.setup_bessel_box"><code class="xref py py-func docutils literal"><span class="pre">setup_bessel_box()</span></code></a> and logarithmize the result. Afterwards the results are multipe with the transition matrix <span class="math">\(N_{m,ij}(t_i)\)</span>. The likelihood thus obtained provides the acceptance criteria for the MC alogirthm and is returned by the function .</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first docutils">
<dt><strong>model</strong> <span class="classifier-delimiter">:</span> <span class="classifier">obj</span></dt>
<dd><p class="first last">model class set with the model function</p>
</dd>
<dt><strong>wrad</strong> <span class="classifier-delimiter">:</span> <span class="classifier">list</span></dt>
<dd><p class="first last">radial diffusion profile which was adapted in the current MC</p>
</dd>
</dl>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>log_like</strong> <span class="classifier-delimiter">:</span> <span class="classifier">float</span></dt>
<dd><p class="first last">likelihood for the current radial diffusion profile in a simulation box</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>


    </div>
      
  </div>
</div>
<footer class="footer">
  <div class="container">
    <p class="pull-right">
      <a href="#">Back to top</a>
      
    </p>
    <p>
        &copy; Copyright 2021, Hamzeh Kraus.<br/>
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.6.6.<br/>
    </p>
  </div>
</footer>
  </body>
</html>