<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>diffusion_bin &#8212; PoreAna 0.1.1 documentation</title>
    <link rel="stylesheet" href="../_static/bootstrap-sphinx.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../_static/style.css" type="text/css" />
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '0.1.1',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true,
        SOURCELINK_SUFFIX: '.txt'
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
<meta charset='utf-8'>
<meta http-equiv='X-UA-Compatible' content='IE=edge,chrome=1'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1'>
<meta name="apple-mobile-web-app-capable" content="yes">
<script type="text/javascript" src="../_static/js/jquery-1.11.0.min.js "></script>
<script type="text/javascript" src="../_static/js/jquery-fix.js "></script>
<script type="text/javascript" src="../_static/bootstrap-3.3.7/js/bootstrap.min.js "></script>
<script type="text/javascript" src="../_static/bootstrap-sphinx.js "></script>

  </head>
  <body>

  <div id="navbar" class="navbar navbar-default navbar-fixed-top">
    <div class="container">
      <div class="navbar-header">
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="../index.html">
          PoreAna</a>
        <span class="navbar-text navbar-version pull-left"><b>0.1</b></span>
      </div>

        <div class="collapse navbar-collapse nav-collapse">
          <ul class="nav navbar-nav">
            
                <li><a href="../api.html">API</a></li>
                <li><a href="../density.html">Density</a></li>
                <li><a href="../diffusion.html">Diffusion</a></li>
            
            
              <li class="dropdown globaltoc-container">
  <a role="button"
     id="dLabelGlobalToc"
     data-toggle="dropdown"
     data-target="#"
     href="../index.html">Site <b class="caret"></b></a>
  <ul class="dropdown-menu globaltoc"
      role="menu"
      aria-labelledby="dLabelGlobalToc"></ul>
</li>
              
                <li class="dropdown">
  <a role="button"
     id="dLabelLocalToc"
     data-toggle="dropdown"
     data-target="#"
     href="#">Page <b class="caret"></b></a>
  <ul class="dropdown-menu localtoc"
      role="menu"
      aria-labelledby="dLabelLocalToc"><ul>
<li><a class="reference internal" href="#">diffusion_bin</a></li>
</ul>
</ul>
</li>
              
            
            
            
            
            
          </ul>

          
            
<form class="navbar-form navbar-right" action="../search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
          
        </div>
    </div>
  </div>

<div class="container">
  <div class="row">
    <div class="body col-md-12 content" role="main">
      
  </div>
<div class=col-md-9 content><div class="section" id="diffusion-bin">
<h1>diffusion_bin<a class="headerlink" href="#diffusion-bin" title="Permalink to this headline">¶</a></h1>
<dl class="function">
<dt id="poreana.sample.diffusion_bin">
<code class="descclassname">poreana.sample.</code><code class="descname">diffusion_bin</code><span class="sig-paren">(</span><em>link_pore</em>, <em>link_traj</em>, <em>link_out</em>, <em>mol</em>, <em>atoms=[]</em>, <em>masses=[]</em>, <em>bin_num=50</em>, <em>entry=0.5</em>, <em>len_obs=1.6e-11</em>, <em>len_frame=2e-12</em>, <em>len_step=2</em>, <em>bin_step_size=1</em>, <em>is_force=False</em><span class="sig-paren">)</span><a class="headerlink" href="#poreana.sample.diffusion_bin" title="Permalink to this definition">¶</a></dt>
<dd><p>This function samples the mean square displacement of a molecule group
in a pore in both axial and radial direction separated in radial bins. This
function is to be run on the cluster due to a high time and resource
consumption. The output, a data object, is then used to calculate the
self-diffusion using further calculation functions.</p>
<p>First a centre of mass-list is filled with <span class="math">\(w\cdot s\)</span>
frames with window length <span class="math">\(w\)</span> and stepsize <span class="math">\(s\)</span>. Each following
frame removes the first com of the list and a new added to the end of it.
This way only one loop over the frames is needed, since each frame is
only needed for <span class="math">\(w\cdot s\)</span> frames in total.</p>
<p>All molecule com’s are sampled each window if they are inside the bounds of
the pore minus an entry length on both sides. Once the com leaves the
boundary, it is no longer sampled for this specific window. Additionally,
the radial bin index is checked for each frame. If the molecule com stays in
the pore for the whole window length and in the same starting bin plus an
allowed offset, the msd is added to it is added to a the corresponding
window starting radial bin. The sub volumes, or rather bins, of the radial
distance are calculated by</p>
<div class="math">
\[V_i^\text{radial}=\pi z_\text{pore}(r_i^2-r_{i-1}^2)\]</div>
<p>with <span class="math">\(r\)</span> of bin <span class="math">\(i\)</span> and pore length <span class="math">\(z_\text{pore}\)</span>.</p>
<p>Once the first com-list is filled, the mean square displacement (msd)
is sampled each frame. The axial diffusion only considers the
deviation in <span class="math">\(z\)</span> direction</p>
<div class="math">
\[\text{msd}_\text{axial}=\langle\left[z(0)-z(t_i)\right]^2\rangle
=\frac{\left[z(0)-z(t_i)\right]^2}{M_i}\]</div>
<p>with time <span class="math">\(t\)</span> and normalization <span class="math">\(M\)</span> at bin <span class="math">\(i\)</span>.
The radial diffusion only considers the radial components <span class="math">\(x\)</span> and
<span class="math">\(y\)</span></p>
<div class="math">
\[\text{msd}_\text{radial}=\langle\left[r(0)-r(t_i)\right]^2\rangle
=\frac{\left[\sqrt{x^2(0)+y^2(0)}-\sqrt{x^2(t_i)+y^2(t_i)}\right]^2}{M_i}.\]</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>link_pore</strong> <span class="classifier-delimiter">:</span> <span class="classifier">string</span></dt>
<dd><p class="first last">Link to poresystem object file</p>
</dd>
<dt><strong>link_traj</strong> <span class="classifier-delimiter">:</span> <span class="classifier">string</span></dt>
<dd><p class="first last">Link to trajectory file (trr or xtc)</p>
</dd>
<dt><strong>link_out</strong> <span class="classifier-delimiter">:</span> <span class="classifier">string</span></dt>
<dd><p class="first last">Link to output object file</p>
</dd>
<dt><strong>mol</strong> <span class="classifier-delimiter">:</span> <span class="classifier">Molecule</span></dt>
<dd><p class="first last">Molecule object to calculate the density for</p>
</dd>
<dt><strong>atoms</strong> <span class="classifier-delimiter">:</span> <span class="classifier">list, optional</span></dt>
<dd><p class="first last">List of atom names, leave empty for whole molecule</p>
</dd>
<dt><strong>masses</strong> <span class="classifier-delimiter">:</span> <span class="classifier">list, optional</span></dt>
<dd><p class="first last">List of atom masses, leave empty to read molecule object masses</p>
</dd>
<dt><strong>bin_num</strong> <span class="classifier-delimiter">:</span> <span class="classifier">integer, optional</span></dt>
<dd><p class="first last">Number of radial bins</p>
</dd>
<dt><strong>entry</strong> <span class="classifier-delimiter">:</span> <span class="classifier">float, optional</span></dt>
<dd><p class="first last">Remove pore entrance from calculation</p>
</dd>
<dt><strong>len_obs</strong> <span class="classifier-delimiter">:</span> <span class="classifier">float, optional</span></dt>
<dd><p class="first last">Observation length of a window in seconds</p>
</dd>
<dt><strong>len_frame</strong> <span class="classifier-delimiter">:</span> <span class="classifier">float, optional</span></dt>
<dd><p class="first last">Length of a frame in seconds</p>
</dd>
<dt><strong>len_step</strong> <span class="classifier-delimiter">:</span> <span class="classifier">integer, optional</span></dt>
<dd><p class="first last">Length of the step size between frames</p>
</dd>
<dt><strong>bin_step_size</strong> <span class="classifier-delimiter">:</span> <span class="classifier">integer, optional</span></dt>
<dd><p class="first last">Number of allowed bins for the molecule to leave</p>
</dd>
<dt><strong>is_force</strong> <span class="classifier-delimiter">:</span> <span class="classifier">bool, optional</span></dt>
<dd><p class="first last">True to force re-extraction of data</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>


    </div>
      
  </div>
</div>
<footer class="footer">
  <div class="container">
    <p class="pull-right">
      <a href="#">Back to top</a>
      
    </p>
    <p>
        &copy; Copyright 2021, Hamzeh Kraus.<br/>
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.6.6.<br/>
    </p>
  </div>
</footer>
  </body>
</html>