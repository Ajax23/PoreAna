<!DOCTYPE html>

<html lang="en" data-content_root="../">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Sample._diffusion_bin &#8212; PoreAna 0.2.3 documentation</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="../_static/bootstrap-sphinx.css?v=cab96e3b" />
    <script src="../_static/documentation_options.js?v=a47416a6"></script>
    <script src="../_static/doctools.js?v=9a2dae69"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
<meta charset='utf-8'>
<meta http-equiv='X-UA-Compatible' content='IE=edge,chrome=1'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1'>
<meta name="apple-mobile-web-app-capable" content="yes">
<script type="text/javascript" src="../_static/js/jquery-1.12.4.min.js"></script>
<script type="text/javascript" src="../_static/js/jquery-fix.js"></script>
<script type="text/javascript" src="../_static/bootstrap-3.4.1/js/bootstrap.min.js"></script>
<script type="text/javascript" src="../_static/bootstrap-sphinx.js"></script>

  </head><body>

  <div id="navbar" class="navbar navbar-default navbar-fixed-top">
    <div class="container">
      <div class="navbar-header">
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="../index.html">
          PoreAna</a>
        <span class="navbar-text navbar-version pull-left"><b>0.2</b></span>
      </div>

        <div class="collapse navbar-collapse nav-collapse">
          <ul class="nav navbar-nav">
            
                <li><a href="../api.html">API</a></li>
                <li><a href="../sample.html">Sample</a></li>
                <li><a href="../density.html">Density</a></li>
                <li><a href="../diffusion_bin.html">Diffusion (Bin)</a></li>
                <li><a href="../diffusion_mc.html">Diffusion (MC)</a></li>
                <li><a href="../further_props.html">Further Properties</a></li>
            
            
              <li class="dropdown globaltoc-container">
  <a role="button"
     id="dLabelGlobalToc"
     data-toggle="dropdown"
     data-target="#"
     href="../index.html">Site <b class="caret"></b></a>
  <ul class="dropdown-menu globaltoc"
      role="menu"
      aria-labelledby="dLabelGlobalToc"></ul>
</li>
              
                <li class="dropdown">
  <a role="button"
     id="dLabelLocalToc"
     data-toggle="dropdown"
     data-target="#"
     href="#">Page <b class="caret"></b></a>
  <ul class="dropdown-menu localtoc"
      role="menu"
      aria-labelledby="dLabelLocalToc"><ul>
<li><a class="reference internal" href="#">Sample._diffusion_bin</a><ul>
<li><a class="reference internal" href="#poreana.sample.Sample._diffusion_bin"><code class="docutils literal notranslate"><span class="pre">Sample._diffusion_bin()</span></code></a></li>
</ul>
</li>
</ul>
</ul>
</li>
              
            
            
            
            
            
          </ul>

          
            
<form class="navbar-form navbar-right" action="../search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
          
        </div>
    </div>
  </div>

<div class="container">
  <div class="row">
      <div class="col-md-3">
        <div id="sidebar" class="bs-sidenav" role="complementary"><ul>
<li><a class="reference internal" href="#">Sample._diffusion_bin</a><ul>
<li><a class="reference internal" href="#poreana.sample.Sample._diffusion_bin"><code class="docutils literal notranslate"><span class="pre">Sample._diffusion_bin()</span></code></a></li>
</ul>
</li>
</ul>

<div id="sourcelink">
  <a href="../_sources/generated/poreana.sample.Sample._diffusion_bin.rst.txt"
     rel="nofollow">Source</a>
</div>
<form action="../search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
        </div>
      </div>
    <div class="body col-md-9 content" role="main">
      
  </div>
<div class=col-md-9 content><section id="sample-diffusion-bin">
<h1>Sample._diffusion_bin<a class="headerlink" href="#sample-diffusion-bin" title="Link to this heading">¶</a></h1>
<dl class="py method">
<dt class="sig sig-object py" id="poreana.sample.Sample._diffusion_bin">
<span class="sig-prename descclassname"><span class="pre">Sample.</span></span><span class="sig-name descname"><span class="pre">_diffusion_bin</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">region</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pore_in</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dist</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">com_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">idx_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">res_id</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">com</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#poreana.sample.Sample._diffusion_bin" title="Link to this definition">¶</a></dt>
<dd><p>This function samples the mean square displacement of a molecule
group in a pore in both axial and radial direction separated in radial
bins.</p>
<p>First a centre of mass-list is filled with <span class="math notranslate nohighlight">\(w\cdot s\)</span> frames with
window length <span class="math notranslate nohighlight">\(w\)</span> and stepsize <span class="math notranslate nohighlight">\(s\)</span>. Each following frame
removes the first com of the list and a new added to the end of it. This
way only one loop over the frames is needed, since each frame is only
needed for <span class="math notranslate nohighlight">\(w\cdot s\)</span> frames in total.</p>
<p>All molecule com’s are sampled each window if they are inside the bounds
of the pore minus an entry length on both sides. Once the com leaves the
boundary, it is no longer sampled for this specific window.
Additionally, the radial bin index is checked for each frame. If the
molecule com stays in the pore for the whole window length and in the
same starting bin plus an allowed offset, the msd is added to it is
added to a the corresponding window starting radial bin. The sub
volumes, or rather bins, of the radial distance are calculated by</p>
<div class="math notranslate nohighlight">
\[V_i^\text{radial}=\pi z_\text{pore}(r_i^2-r_{i-1}^2)\]</div>
<p>with <span class="math notranslate nohighlight">\(r\)</span> of bin <span class="math notranslate nohighlight">\(i\)</span> and pore length <span class="math notranslate nohighlight">\(z_\text{pore}\)</span>.</p>
<p>Once the first com-list is filled, the mean square displacement (msd)
is sampled each frame. The axial diffusion only considers the
deviation in <span class="math notranslate nohighlight">\(z\)</span> direction</p>
<div class="math notranslate nohighlight">
\[\text{msd}_\text{axial}=\langle\left[z(0)-z(t_i)\right]^2\rangle
=\frac{\left[z(0)-z(t_i)\right]^2}{M_i}\]</div>
<p>with time <span class="math notranslate nohighlight">\(t\)</span> and normalization <span class="math notranslate nohighlight">\(M\)</span> at bin <span class="math notranslate nohighlight">\(i\)</span>.
The radial diffusion only considers the radial components <span class="math notranslate nohighlight">\(x\)</span> and
<span class="math notranslate nohighlight">\(y\)</span></p>
<div class="math notranslate nohighlight">
\[\text{msd}_\text{radial}=\langle\left[r(0)-r(t_i)\right]^2\rangle
=\frac{\left[\sqrt{x^2(0)+y^2(0)}-\sqrt{x^2(t_i)+y^2(t_i)}\right]^2}{M_i}.\]</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>data</strong><span class="classifier">dictionary</span></dt><dd><p>Data dictionary containing bins for axial and radial diffusion</p>
</dd>
<dt><strong>region</strong><span class="classifier">string</span></dt><dd><p>Indicator wether molecule is inside or outside pore</p>
</dd>
<dt><strong>dist</strong><span class="classifier">float</span></dt><dd><p>Distance of center of mass to pore surface area</p>
</dd>
<dt><strong>com_list</strong><span class="classifier">list</span></dt><dd><p>List of dictionaries containing coms of all molecules for each frame</p>
</dd>
<dt><strong>index_list</strong><span class="classifier">list</span></dt><dd><p>List of dictionaries containing bin id of all molecules for each frame</p>
</dd>
<dt><strong>res_id</strong><span class="classifier">integer</span></dt><dd><p>Current residue id</p>
</dd>
<dt><strong>com</strong><span class="classifier">list</span></dt><dd><p>Center of mass of current molecule</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

</section>


    </div>
      
  </div>
</div>
<footer class="footer">
  <div class="container">
    <p class="pull-right">
      <a href="#">Back to top</a>
      
    </p>
    <p>
        &copy; Copyright 2021, Hamzeh Kraus.<br/>
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 7.4.6.<br/>
    </p>
  </div>
</footer>
  </body>
</html>